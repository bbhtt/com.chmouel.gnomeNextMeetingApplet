name: gnome-next-meeting-applet
buildsystem: simple
build-commands:
  - pip3 install --exists-action=i --no-index --find-links="file://${PWD}" --prefix=${FLATPAK_DEST} gnome_next_meeting_applet --no-build-isolation
  - cp -a data/images/  ${FLATPAK_DEST}/share/icons/gnome-next-meeting-applet
  - install -Dp -m644 data/desktop/icon.svg ${FLATPAK_DEST}/share/icons/hicolor/scalable/apps/com.chmouel.gnomeNextMeetingApplet.svg
  - install -Dp -m644 data/desktop/com.chmouel.gnomeNextMeetingApplet.appdata.xml ${FLATPAK_DEST}/share/metainfo
  - install -Dp -m644 data/desktop/com.chmouel.gnomeNextMeetingApplet.desktop ${FLATPAK_DEST}/share/applications/
  - desktop-file-edit --set-key=Icon --set-value=com.chmouel.gnomeNextMeetingApplet ${FLATPAK_DEST}/share/applications/com.chmouel.gnomeNextMeetingApplet.desktop
sources:
  # I can't get poetry not trying to access network, so we need the wheel for
  # install and the tarball for metadatas stuff.
  # metadatas install in wheel with poetry is weird as well since we cannot set
  # the path name of the includes like we used to do with setuptool
  - type: archive
    url: https://github.com/chmouel/gnome-next-meeting-applet/releases/download/2.4.1/gnome-next-meeting-applet-2.4.1.tar.gz
    sha256: 8f72558a3b3fad9b2e634803d00f8cc078cb1125c427d8a6c76937dc95e9f92a

  - type: file
    url: https://github.com/chmouel/gnome-next-meeting-applet/releases/download/2.4.1/gnome_next_meeting_applet-2.4.1-py3-none-any.whl
    sha256: 47f01058ac2ea2d945be5c45301e163c83928312ecfdedf2ee719958cde9884d
